---
layout: default
---

<article class="posts">
  
  <h1>{{ page.title }}</h1>

  <div clsss="meta">
    <span class="date">
      {{ page.date | date: "%Y-%m-%d" }}
    </span>

    <ul class="tag">
      {% for tag in page.tags %}
      <li>
        <a href="{{ site.url }}{{ site.baseurl }}/tags#{{ tag }}">
          {{ tag }}
        </a>
      </li>
      {% endfor %}
    </ul>
  </div>

  

  <div class="entry">
    {{ content }}
  </div>

  {% include disqus.html %}
  {% include gitalk.html %}
</article>

<div class="pagination">
  {% if page.previous.url %}
    <span class="prev" >
      <a href="{{ site.url }}{{ site.baseurl }}{{ page.previous.url }}">
        ← 上一篇
      </a>
    </span>
  {% endif %}
  {% if page.next.url %}
    <span class="next" >
      <a href="{{ site.url }}{{ site.baseurl }}{{ page.next.url }}">
        下一篇 →
      </a>
    </span>
  {% endif %}
</div>

{ % if page.mermaid % }

<script>
function initMermaid() {
  var config = {
    startOnLoad: true,
    securityLevel: 'loose',
    theme: 'base',
    themeVariables: {
      primaryColor: '#F0F4FC',
      primaryTextColor: '#1F2329',
      primaryBorderColor: '#000000',
      lineColor: '#888888',
      tertiaryColor: '#F5F6F7',
      tertiaryBorderColor: '#F5F6F7',
      tertiaryTextColor: '#00A4FF'
    },
    flowchart:{
      useMaxWidth: true,
      htmlLabels: true
    }
  };
  mermaid.initialize(config);
  window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
  document.addEventListener("DOMContentLoaded", () => {
  // 获取 Mermaid 渲染的 SVG 元素
  const mermaidContainer = document.getElementById("mermaid-container");
  const svgElement = mermaidContainer.querySelector("svg");

  if (!svgElement) {
    console.error("Mermaid SVG not found!");
    return;
  }

  // 使用 Rough.js 对 SVG 进行手绘化处理
  const rough = rough.svg(svgElement); // 初始化 Rough.js

  // 遍历所有节点和边线，替换为手绘风格
  const nodes = svgElement.querySelectorAll("rect, polygon, path");
  nodes.forEach((node) => {
    const bbox = node.getBBox(); // 获取节点的边界框

    // 根据节点类型创建 Rough.js 的手绘元素
    let roughElement;
    if (node.tagName === "rect") {
      roughElement = rough.rectangle(bbox.x, bbox.y, bbox.width, bbox.height, {
        roughness: 2, // 手绘风格的粗糙度
        stroke: "black",
        fill: "white",
        fillStyle: "hachure", // 填充样式（手绘线条填充）
      });
    } else if (node.tagName === "polygon") {
      const points = node.getAttribute("points").split(" ").map((p) => {
        const [x, y] = p.split(",");
        return [parseFloat(x), parseFloat(y)];
      });
      roughElement = rough.polygon(points, {
        roughness: 2,
        stroke: "black",
        fill: "white",
        fillStyle: "hachure",
      });
    } else if (node.tagName === "path") {
      const d = node.getAttribute("d");
      roughElement = rough.path(d, {
        roughness: 2,
        stroke: "black",
      });
    }

    // 替换原始节点
    if (roughElement) {
      svgElement.appendChild(roughElement);
      node.remove(); // 移除原始节点
    }
  });
});
}
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/mermaid/11.7.0/mermaid.min.js"
  async
  onload="initMermaid()">
</script>
<script src="https://cdn.jsdelivr.net/npm/roughjs/bundled/rough.min.js"></script>

{ % endif % }